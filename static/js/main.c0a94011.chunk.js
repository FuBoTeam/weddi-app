(this["webpackJsonpweddi-app"]=this["webpackJsonpweddi-app"]||[]).push([[0],{31:function(e,t,n){},37:function(e,t,n){e.exports=n.p+"static/media/loading.822699a4.gif"},40:function(e,t,n){e.exports=n(69)},45:function(e,t,n){},60:function(e,t,n){},69:function(e,t,n){"use strict";n.r(t);var a,i=n(0),r=n.n(i),o=n(36),s=n.n(o),c=n(21),l=n(8),m=(n(45),n(14)),u=n(4),g=n(5),d=n(12),p=n(10),f=n(6),h=n(11),b=n(15),v=n.n(b),y=(n(60),{doc:{title:"<3 YaYun & ChinHui <3"},db:{apiKey:"AIzaSyD_1irJWOgT9x5fvmbXJm0fRRRZ8DNUfpU",authDomain:"weddi-app.firebaseapp.com",databaseURL:"https://weddi-app.firebaseio.com/",projectId:"weddi-app",storageBucket:"weddi-app.appspot.com",messagingSenderId:"324415165027",appId:"1:324415165027:web:76b8291835ef32c5c75e56"},img:{endpoint:"https://storage.googleapis.com/image.weddi.app/chyy/",totalImgs:114,bgImgsShouldBePicked:40,fmImgsShouldBePicked:5}}),w={doc:{title:"<3 \u6c34\u6bcd & \u5370\u9ea5\u738b <3"},db:{apiKey:"AIzaSyD_1irJWOgT9x5fvmbXJm0fRRRZ8DNUfpU",authDomain:"weddi-app.firebaseapp.com",databaseURL:"https://weddi-app-test.firebaseio.com/",projectId:"weddi-app",storageBucket:"weddi-app.appspot.com",messagingSenderId:"324415165027",appId:"1:324415165027:web:76b8291835ef32c5c75e56"},img:{endpoint:"https://storage.googleapis.com/image.weddi.app/tlty/",totalImgs:30,bgImgsShouldBePicked:30,fmImgsShouldBePicked:5}},I={doc:{title:"<3 Groom & Bride <3"},db:{apiKey:"AIzaSyD_1irJWOgT9x5fvmbXJm0fRRRZ8DNUfpU",authDomain:"weddi-app.firebaseapp.com",databaseURL:"https://weddi-app-test.firebaseio.com/",projectId:"weddi-app",storageBucket:"weddi-app.appspot.com",messagingSenderId:"324415165027",appId:"1:324415165027:web:76b8291835ef32c5c75e56"},img:{endpoint:"https://storage.googleapis.com/image.weddi.app/chyy/",totalImgs:114,bgImgsShouldBePicked:40,fmImgsShouldBePicked:5}},O={init:function(e){return a||(a=function(e){switch(e){case"chyy":return y;case"tlty":return w;default:return I}}(e)),a},getDocConfig:function(){return a.doc},getDBConfig:function(){return a.db},getImgConfig:function(){return a.img}},k=n(22),j=n.n(k),E=function(e,t){for(var n=[],a=e.length-t;a<e.length;a++){var i=j()(a);n.includes(e[i])?n.push(e[a]):n.push(e[i])}return n},S=function(e){for(var t=0;t<=e.length-2;t++){var n=j()(t,e.length-1),a=[e[n],e[t]];e[t]=a[0],e[n]=a[1]}return e},U=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"_small";return"".concat(O.getImgConfig().endpoint).concat(e).concat(t,".jpg")},D=(n(31),function(e){function t(){var e;Object(u.a)(this,t),(e=Object(d.a)(this,Object(p.a)(t).call(this))).img=new Image;var n=Object(f.a)(e);return e.img.onload=function(){var e=this;n.setState((function(){return{imgWidth:e.width||0,imgHeight:e.height||0}}))},e.state={imgWidth:0,imgHeight:0},e}return Object(h.a)(t,e),Object(g.a)(t,[{key:"componentDidUpdate",value:function(){this.img.src=this.props.show?this.props.user.imgUrl:""}},{key:"render",value:function(){var e=this.props,t=e.user,n=e.show,a=window.innerWidth<1e3,i=this.state.imgWidth<this.state.imgHeight,o=n&&a&&i?{margin:"10% 20% 50px"}:{};return r.a.createElement("div",{className:n?"dialog show-dialog":"dialog"},r.a.createElement("div",{className:"modal-sm",style:o},r.a.createElement("div",{className:"image-container"},r.a.createElement("img",{className:"user-image",src:t.imgUrl,alt:"images"})),r.a.createElement("div",{className:"message"},r.a.createElement("h2",null,"@ ",t.name),r.a.createElement("p",null,t.greetings))))}}]),t}(i.Component)),P=n(16);n(62);function N(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}var B,x=function(){function e(){Object(u.a)(this,e),this.app=P.initializeApp(O.getDBConfig()),this.firebase=P,this.database=P.database()}return Object(g.a)(e,[{key:"getDB",value:function(){return this.database}}]),e}(),C=function(){return B||(B=new x),B},T=function(e){var t=B.getDB().ref().child("posts").push().key,n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?N(n,!0).forEach((function(t){Object(m.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):N(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e,{modifiedTime:(new Date).toISOString(),userAgent:navigator.userAgent,id:t});return B.getDB().ref("posts/".concat(t)).set(n)},H=function(e){B.getDB().ref("posts").on("child_added",(function(t){e(t.val())}))};function R(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function W(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?R(n,!0).forEach((function(t){Object(m.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):R(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var L=function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(n=Object(d.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(i)))).allImgUrls=v()(O.getImgConfig().totalImgs).map((function(e){return U(e)})),n.fmImgsShouldBePicked=O.getImgConfig().fmImgsShouldBePicked,n.imgUrls=E(n.allImgUrls,n.fmImgsShouldBePicked),n.state={form:{name:"",greetings:"",imgPicked:0,imgUrl:n.imgUrls[0]},modalDisplay:!1},n.onTextChangeHandler=n.onTextChangeHandler.bind(Object(f.a)(n)),n.onSubmitHandler=n.onSubmitHandler.bind(Object(f.a)(n)),n.isValid=n.isValid.bind(Object(f.a)(n)),n.setImgIdx=n.setImgIdx.bind(Object(f.a)(n)),n.plusImgIdx=n.plusImgIdx.bind(Object(f.a)(n)),n}return Object(h.a)(t,e),Object(g.a)(t,[{key:"getUpperUrl",value:function(){var e=this.props.match.url.split("/");return e.pop(),e.join("/")}},{key:"onTextChangeHandler",value:function(e){e.preventDefault();var t=e.target.name,n=e.target.value.trim();this.setState((function(e){return{form:W({},e.form,Object(m.a)({},t,n))}}))}},{key:"onSubmitHandler",value:function(e){var t=this;if(e.preventDefault(),this.isValid())return T(this.state.form).then((function(){t.setState({modalDisplay:!0}),setTimeout((function(){t.props.history.push(t.getUpperUrl())}),3e3)}))}},{key:"setImgIdx",value:function(e){var t=this.imgUrls[e];this.setState((function(n){return{form:W({},n.form,{imgPicked:e,imgUrl:t})}}))}},{key:"plusImgIdx",value:function(e){var t=(this.state.form.imgPicked+e+this.fmImgsShouldBePicked)%this.fmImgsShouldBePicked;this.setImgIdx(t)}},{key:"isValid",value:function(){var e=this.state.form,t=e.name,n=e.greetings,a=e.imgUrl;return""!==t.trim()&&""!==n.trim()&&""!==a.trim()}},{key:"render",value:function(){var e=this,t=this.imgUrls.map((function(t,n){var a=e.state.form.imgPicked===n;return r.a.createElement("div",{key:n,className:"fade",style:a?{display:"block"}:{display:"none"}},r.a.createElement("div",{className:"numbertext"},n+1," / ",e.fmImgsShouldBePicked),r.a.createElement("label",null,r.a.createElement("input",{style:{display:"none"},type:"radio",name:"imgUrl",value:t,onChange:e.onTextChangeHandler,required:!0,checked:a}),r.a.createElement("img",{className:"img-choice",style:{border:"5px solid white"},src:t,alt:t})))}));return r.a.createElement("div",{className:"greeting"},r.a.createElement("header",{className:"greeting-header"},r.a.createElement("h1",{className:"greeting-title"},"\u795d\u798f\u7559\u8a00\u7248")),!this.state.modalDisplay&&r.a.createElement("form",{className:"greeting-form",onSubmit:this.onSubmitHandler},r.a.createElement("label",{className:"pick"},"\u6311\u4e00\u5f35\u7167\u7247"),r.a.createElement("div",{className:"slideshow-container"},t,r.a.createElement("a",{className:"prev",onClick:function(){return e.plusImgIdx(-1)}},"\u276e"),r.a.createElement("a",{className:"next",onClick:function(){return e.plusImgIdx(1)}},"\u276f")),r.a.createElement("div",{className:"greeting-message-block"},r.a.createElement("label",{className:"input"},r.a.createElement("h2",null,"@"),r.a.createElement("input",{type:"text",name:"name",placeholder:"\u59d3\u540d",onChange:this.onTextChangeHandler,required:!0})),r.a.createElement("label",{className:"input"},r.a.createElement("textarea",{name:"greetings",placeholder:"\u795d\u8cc0\u8a5e",onChange:this.onTextChangeHandler,required:!0}))),r.a.createElement("input",{className:"btn",type:"submit",value:"\u7559\u8a00"}),r.a.createElement("a",{className:"link",href:this.getUpperUrl()},"\u53bb\u7167\u7247\u7246\u77a7\u77a7")),r.a.createElement(D,{user:this.state.form,show:this.state.modalDisplay}))}}]),t}(i.Component),A=n(25),J=n(37),q=n.n(J),_=function(){function e(){Object(u.a)(this,e),this.q=[]}return Object(g.a)(e,[{key:"push",value:function(e){this.q.push(e)}},{key:"pop",value:function(){return this.q.splice(0,1)[0]}},{key:"isEmpty",value:function(){return 0===this.q.length}}]),e}(),z=function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(n=Object(d.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(i)))).allImgUrls=v()(O.getImgConfig().totalImgs).map((function(e){return U(e)})),n.bgImgUrls=E(n.allImgUrls,O.getImgConfig().bgImgsShouldBePicked),n.bgImgUrls=S([].concat(Object(A.a)(n.bgImgUrls),Object(A.a)(n.bgImgUrls))),n.intervals=[],n.state={isLoading:!0,modalDisplay:!1,user:{},bgImgUrls:n.bgImgUrls,isBgSwitching:!1},n.showDialog=function(e){n.setState((function(){return{modalDisplay:!0,user:Object.assign({},e)}})),setTimeout((function(){n.setState((function(){return{modalDisplay:!1}}))}),5e3)},n.pickUpFeed=function(e,t){var a=e.isEmpty()?t.pop():e.pop();n.showDialog(a),t.push(a)},n}return Object(h.a)(t,e),Object(g.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=new _,n=new _;H((function(e){return t.push(e)})),window.onload=function(){e.setState((function(e){return{isLoading:!e.isLoading}})),e.intervals.push(setInterval((function(){e.pickUpFeed(t,n)}),8e3))},setInterval((function(){e.setState({isBgSwitching:!0}),setTimeout((function(){e.setState({bgImgUrls:S(e.state.bgImgUrls)}),setTimeout((function(){e.setState({isBgSwitching:!1})}),1e3)}),1e3)}),3e5)}},{key:"componentWillUnmount",value:function(){clearInterval(this.intervals)}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"container"},this.state.isLoading&&r.a.createElement("div",{className:"loading"},r.a.createElement("img",{src:q.a,alt:""}),r.a.createElement("span",null,"Loading...")),r.a.createElement("section",{className:"pic-container"},this.bgImgUrls.map((function(t,n){return r.a.createElement("div",{key:"".concat(t,"_").concat(n),className:e.state.isLoading||e.state.isBgSwitching?"pic-block hidden":"pic-block visible"},r.a.createElement("img",{src:t,alt:""}))}))),r.a.createElement(D,{user:this.state.user,show:this.state.modalDisplay}),r.a.createElement("a",{className:"message-link",href:"".concat(this.props.match.url,"/greetings")},"<< \u7559\u4e0b\u4f60\u7684\u795d\u798f"))}}]),t}(i.Component),V=function(e){var t,n=e.match;O.init(n.params.gnbId),C(),t=O.getDocConfig().title,document.title=t;var a=n.url;return r.a.createElement(l.c,null,r.a.createElement(l.a,{path:"".concat(a,"/greetings"),component:L}),r.a.createElement(l.a,{path:a,component:z}))},K=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function X(e){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var Z=function(){return r.a.createElement("div",null,"Weddi App")};s.a.render(r.a.createElement((function(){return r.a.createElement(c.a,{basename:"",forceRefresh:!0},r.a.createElement(l.c,null,r.a.createElement(l.a,{path:"/:gnbId/",component:V}),r.a.createElement(l.a,{path:"/",component:Z})))}),null),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("",window.location).origin!==window.location.origin)return;window.addEventListener("load",(function(){var e="".concat("","/service-worker.js");K?(!function(e){fetch(e).then((function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):X(e)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")}))):X(e)}))}}()}},[[40,1,2]]]);
//# sourceMappingURL=main.c0a94011.chunk.js.map